# üìä Google Sheets Auto-Filler

**EN**

**Google Sheets Auto-Filler** is a Python script that automatically checks for editing access to a Google Sheets document, retrieves data from priority cells, and writes to the first available cell with the specified text. If the data is not saved, the script retries until the write operation is successful.

The script is designed for automatic filling of Google Sheets with an editing access waiting function.

### üìå Example Use Case

Imagine you need to select a topic for your coursework. There are 100 students and 100 available topics, with each student getting one topic. Among these, only one is suitable for you.

Your instructor publishes 100 topics in a **read-only** Google Sheet. At an unspecified (or predetermined) time, the sheet will be opened for editing, allowing you to select a topic. **This script provides an advantage over other participants** by checking for edit access every second. Once access is detected, it checks priority cells in descending order of priority:

```python
PRIORITY_CELLS = ["A1", "A2", "A3", ..., "A9"]
# A1 - Best topic (highest priority)
# A9 - Worst topic (lowest priority)
```

The script will attempt to write your **TEXT** (topic number or surname) **to the highest-priority available cell**, which:

- Is **empty** (null, spaces, or symbols‚Äîwithout letters or numbers)
- **Contains the CHECK_PREFIX value**

If **CHECK_PREFIX = "John"**, and a cell contains "John" or is empty, the script writes your **TEXT** to it. If the cell contains something else (e.g., "Kriss" or "123"), the script moves to the next priority cell.

---

## üöÄ Features

- ‚úÖ Automatically retrieves data from specified Google Sheets cells.
- ‚úÖ Checks for edit access.
- ‚úÖ Writes specified **text** to the first available cell.
- ‚úÖ Allows modification of **spreadsheet ID** and **specific sheet ID**.
- ‚úÖ Configurable **data validation threshold** (e.g., if the text is shorter than 3 characters or contains only symbols).
- ‚úÖ Handles **API errors** (waits and retries if the API is temporarily unavailable).
- ‚úÖ Supports **two languages** (English/Russian) by changing the `LANGUAGE` variable.

---

## üõ†Ô∏è Installation and Setup

### **1Ô∏è‚É£ Install Dependencies**

```bash
pip install -r requirements.txt
```


### **2Ô∏è‚É£ Create a Google API Account and Download JSON Credentials**

1. Go to [Google Cloud Console](https://console.cloud.google.com/).
2. Enable the Google Sheets API.
3. Create a service account and download the JSON credentials file.
4. Add the service account email to Google Sheets as an **Editor**.

### **3Ô∏è‚É£ Save the JSON Credentials File**

Place the JSON file (e.g., `credentials.json`) in the project's root directory.

### **4Ô∏è‚É£ Configure Variables in `config.py`**

```python
CREDENTIALS_FILE = 'credentials.json'  # Credentials file
SPREADSHEET_ID = 'your_spreadsheet_id'  # Google Sheets ID
SHEET_ID = 0  # Specific sheet ID (0 = first sheet)
TEXT = "Last Name First Name"  # Text to be written
CHECK_PREFIX = "Last"  # Prefix to check (e.g., "John")
PRIORITY_CELLS = ['B3', 'B8', 'B6', 'B12', 'B17']  # Priority cells
LANGUAGE = "en"  # Language: "en" or "ru"
```

### üîç How to Get `SPREADSHEET_ID` and `SHEET_ID`?

- **SPREADSHEET_ID** can be found in the Google Sheets URL:
  ```
  https://docs.google.com/spreadsheets/d/YOUR_SPREADSHEET_ID/edit#gid=0
  ```
- **SHEET_ID** is the number after `gid=` in the URL:
  ```
  https://docs.google.com/spreadsheets/d/58nhlnFIUZBPNfPWrJYKhkdvm-8fPb2CKbdOLUxiO1nap/htmlview?gid=0#gid=0
  ```
  In this example, `SHEET_ID = 0`.

---

## üîÑ How the Script Works

1Ô∏è‚É£ **Checks for access** to the sheet (reader or editor).
2Ô∏è‚É£ **Retrieves data** from priority cells.
3Ô∏è‚É£ If **"TEXT" is already recorded** in one of the cells ‚Äî **the script stops**.
4Ô∏è‚É£ **Cells are processed in priority order**. The text is written to **the first suitable cell**, which:

- Is **empty**.
- Contains **CHECK_PREFIX** (e.g., if `CHECK_PREFIX = "12345"`, **it will write to a cell with "12345"**).

5Ô∏è‚É£ If **after writing, only CHECK_PREFIX remains** (e.g., "John") ‚Äî **it completes the full text**.
6Ô∏è‚É£ If the text is removed **after insertion** ‚Äî it tries the next available cell.

---

## üèÉ Running the Script

```bash
python main.py
```

---

## üìù License

This project is distributed under the **MIT License**. You are free to use and modify the code without restrictions.

---

üöÄ **Thank you for using Google Sheets Auto-Filler!** üéâ

---

# üìä Google Sheets Auto-Updater

**RU**

**Google Sheets Auto-Updater** ‚Äî —ç—Ç–æ Python-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ç–∞–±–ª–∏—Ü—ã Google Sheets, –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —è—á–µ–µ–∫ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ø–µ—Ä–≤—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é —è—á–µ–π–∫—É –∑–∞–¥–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å, —Å–∫—Ä–∏–ø—Ç –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–æ–ø—ã—Ç–∫—É –¥–æ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —è—á–µ–µ–∫ Google Sheets.
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ç–∞–±–ª–∏—Ü—ã.
- ‚úÖ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ø–µ—Ä–≤—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é —è—á–µ–π–∫—É –∑–∞–¥–∞–Ω–Ω—ã–π **—Ç–µ–∫—Å—Ç**.
- ‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å **ID —Ç–∞–±–ª–∏—Ü—ã** –∏ **ID –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞**.
- ‚úÖ –ì–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π **–ø–æ—Ä–æ–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –º–µ–Ω—å—à–µ 3 —Å–∏–º–≤–æ–ª–æ–≤).
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **–æ—à–∏–±–∫–∏ API** (–µ—Å–ª–∏ API –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∫–æ–¥ –∂–¥–µ—Ç –∏ –ø—Ä–æ–±—É–µ—Ç —Å–Ω–æ–≤–∞).

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### **1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```bash
pip install -r requirements.txt
```
```bash
pip install gspread oauth2client
```

### **2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å Google API –∏ —Å–∫–∞—á–∞–π—Ç–µ JSON-—Ñ–∞–π–ª**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/).
2. –í–∫–ª—é—á–∏—Ç–µ API Google Sheets.
3. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏ —Å–∫–∞—á–∞–π—Ç–µ JSON-—Ñ–∞–π–ª —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
4. –î–æ–±–∞–≤—å—Ç–µ email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –¥–æ—Å—Ç—É–ø –∫ Google Sheets (–∫–∞–∫ **–†–µ–¥–∞–∫—Ç–æ—Ä**).

### **3Ô∏è‚É£ –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ JSON-—Ñ–∞–π–ª —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**
–ü–æ–º–µ—Å—Ç–∏—Ç–µ JSON-—Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `credentials.json`) –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞.

### **4Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `config.py`**
```python
CREDENTIALS_FILE = 'credentials.json'  # –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
SPREADSHEET_ID = '12nhlnFIUZBPNyPWrJYKhkdvm-8fPb2CKbaOLUxiOLB0'  # ID Google-—Ç–∞–±–ª–∏—Ü—ã
SHEET_ID = 0  # ID –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ (0 = –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç)
TEXT = "–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ"  # –ß—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å
CHECK_PREFIX = "–§–∞–º–∏–ª"  # –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–π –ø—Ä–µ—Ñ–∏–∫—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–æ—Å—å—è")
PRIORITY_CELLS = ['B3', 'B8', 'B6', 'B12', 'B17']  # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —è—á–µ–µ–∫
```

---

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç?

1Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø** –∫ —Ç–∞–±–ª–∏—Ü–µ (—á–∏—Ç–∞—Ç–µ–ª—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä).  
2Ô∏è‚É£ **–ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ** –∏–∑ —è—á–µ–µ–∫ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º.  
3Ô∏è‚É£ –ï—Å–ª–∏ **"TEXT" —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω** –≤ –æ–¥–Ω–æ–π –∏–∑ —è—á–µ–µ–∫ ‚Äî **—Å–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É**.  
4Ô∏è‚É£ **–Ø—á–µ–π–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞**. –¢–µ–∫—Å—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ **–ø–µ—Ä–≤—É—é –ø–æ–¥—Ö–æ–¥—è—â—É—é —è—á–µ–π–∫—É**, –∫–æ—Ç–æ—Ä–∞—è:
   - –õ–∏–±–æ **–ø—É—Å—Ç–∞**.
   - –õ–∏–±–æ —Å–æ–¥–µ—Ä–∂–∏—Ç **CHECK_PREFIX** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ `CHECK_PREFIX = "12345"`, —Ç–æ **–≤ —è—á–µ–π–∫—É —Å `12345` —Ç–µ–∫—Å—Ç –∑–∞–ø–∏—à–µ—Ç—Å—è**, –Ω–æ **–Ω–µ –∑–∞–ø–∏—à–µ—Ç—Å—è –≤ `123456`**, –∏ –∑–∞–ø–∏—à–µ—Ç—Å—è –≤ `123`).
5Ô∏è‚É£ –ï—Å–ª–∏ **–ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –æ—Å—Ç–∞–ª–æ—Å—å CHECK_PREFIX** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–æ—Å—å—è") ‚Äî **–¥–æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**.  
6Ô∏è‚É£ –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —É–¥–∞–ª—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏** ‚Äî –ø—Ä–æ–±—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é —è—á–µ–π–∫—É.  

---

## üèÉ –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞

```bash
python main.py
```

---

## üìå –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã
```bash
üîπ SPREADSHEET_ID: 12nhlnFIUZBPNyPWrJYKhkdvm-8fPb2CKbaOLUxiOLB0
üîπ SHEET_ID: 0
üîπ TEXT: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á
üîπ CHECK_PREFIX: –ò–≤–∞–Ω

üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø...
‚úÖ –î–æ—Å—Ç—É–ø –∫ –∑–∞–ø–∏—Å–∏ –µ—Å—Ç—å!
üìã –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–µ–∫: {'B3': '', 'B8': '', 'B6': '', 'B12': '', 'B17': ''}
‚úÖ –ó–∞–ø–∏—Å–∞–ª–∏ '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á' –≤ B3
üéâ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–∏—Å–∞–Ω–æ '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á' –≤ B3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞.
```

---

## ‚ùó –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–µ

### **1Ô∏è‚É£ –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (APIError: 403)**
üîπ **–ü—Ä–∏—á–∏–Ω–∞:** –ê–∫–∫–∞—É–Ω—Ç –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ Google Sheets.  
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ **–¥–æ—Å—Ç—É–ø** –∫ Google Sheets.

### **2Ô∏è‚É£ –û—à–∏–±–∫–∞ "Invalid range" –∏–ª–∏ "Invalid requests"**
üîπ **–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —è—á–µ–π–∫–∞—Ö –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.  
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ª–∏—Å—Ç –∏ —è—á–µ–π–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ.

### **3Ô∏è‚É£ –û—à–∏–±–∫–∞ "Quota exceeded" (–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç API)**
üîπ **–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã.  
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á—å—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (`time.sleep(1)` ‚Üí `time.sleep(5)`).

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä
üìå **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** [–í–∞—à–µ –∏–º—è / GitHub](https://github.com/your-profile)  
üìå **–ö–æ–Ω—Ç–∞–∫—Ç—ã:** your.email@example.com  

üöÄ **–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Google Sheets Auto-Updater!** üéâ


